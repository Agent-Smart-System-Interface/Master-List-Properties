<!doctype html> 
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>smart properties system ¬∑ details</title>
<link rel="preconnect" href="https://script.google.com">
<link rel="preconnect" href="https://lh3.googleusercontent.com">
<style>
/* ====== (‡∏Ñ‡∏á CSS ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì) ====== */
:root{
--bg:#a8bdd6;
--card:#ffffff;
--text:#0f172a;
--muted:#6b7c93;
--radius:22px;
--shadow: 0 12px 30px rgba(0,0,0,.12);
--soft:#f3f6fb;
--line:rgba(255,255,255,.45);
}
*{box-sizing:border-box}
body{
margin:0;
font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans Thai", sans-serif;
background: radial-gradient(ellipse at top, rgba(255,255,255,.25), rgba(255,255,255,0) 55%) , var(--bg);
color:var(--text);
}
.wrap{max-width:1100px; margin:0 auto; padding:16px 14px 30px;}
.topbar{
display:flex; align-items:center; justify-content:space-between;
padding:12px 12px;
border-radius: 18px;
background: rgba(255,255,255,.18);
backdrop-filter: blur(10px);
border: 1px solid var(--line);
}
.brand{display:flex; gap:12px; align-items:center;}
.logo{
width:44px; height:44px; border-radius:999px; background:rgba(255,255,255,.55);
display:grid; place-items:center; font-weight:800;
flex:0 0 auto;
text-decoration:none;
color: inherit;
}
.logo:active{ transform: scale(.99); }
.logo svg{ width:22px; height:22px; display:block; }
.titles{min-width:0}
.titles h1{
margin:0;
font-size:20px;
line-height:1.15;
font-weight:1100;
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
letter-spacing:.2px;
}
.titles .sub{display:none;}
.backBtn{
width:44px; height:44px; border-radius:999px;
border:0; background: rgba(255,255,255,.55);
cursor:pointer; font-size:18px; font-weight:900;
flex:0  0 auto;
}
.card{
margin-top:14px;
background: rgba(255,255,255,.88);
border:1px solid rgba(255,255,255,.65);
border-radius: var(--radius);
box-shadow: var(--shadow);
overflow:hidden;
}
/* Gallery */
.gallery{
position:relative;
background:#dfe9f6;
}
.mainSlide{
width:100%;
aspect-ratio: 16/10;
object-fit:cover;
display:block;
}
.tagTopLeft{
position:absolute;
left:24px;
top:24px;
padding:16px 30px;
border-radius:999px;
background: rgba(255,255,255,.92);
border:0;
box-shadow:none;
backdrop-filter:none;
font-weight:1100;
font-size:42px;
line-height:1;
color:#0f172a;
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
max-width:78%;
}
.tagBottomRight{
position:absolute;
right:24px;
bottom:22px;
padding:0;
border-radius:0;
background:transparent;
border:0;
box-shadow:none;
backdrop-filter:none;
font-weight:1100;
font-size:36px;
line-height:1;
color: rgba(255,255,255,1);
text-shadow: 0 8px 16px rgba(0,0,0,.38);
user-select:none;
pointer-events:none;
}
@media (max-width: 520px){
  .tagTopLeft{
    left:18px;
    top:18px;
    padding:6px 11px;
    font-size:17px;
  }
  .tagBottomRight{
    right:18px;
    bottom:18px;
    font-size:12px;
    text-shadow: 0 10px 18px rgba(0,0,0,.40);
  }
}
.thumbStrip{
background: rgba(255,255,255,.78);
padding:10px;
display:flex;
gap:10px;
overflow:auto;
scroll-snap-type: x mandatory;
}
.thumb{
width:92px; height:64px;
flex:0 0 auto;
border-radius: 16px;
object-fit:cover;
border:3px solid transparent;
cursor:pointer;
scroll-snap-align: start;
background:#e8f0fb;
}
.thumb.active{border-color:#0f172a;}
.content{padding:14px;}
.headRow{
display:flex;
align-items:center;
justify-content:space-between;
gap:10px;
flex-wrap:nowrap;
}
.hp{display:none;}
.price{
font-size:28px;
font-weight:1100;
letter-spacing:.2px;
white-space:nowrap;
flex:1 1 auto;
min-width:0;
}
.statusBelow{
display:inline-flex;
align-items:center;
justify-content:center;
padding:8px 12px;
border-radius: 12px;
font-weight:1100;
font-size:16px;
line-height:1;
background: rgba(255,255,255,.92);
border: 2px solid rgba(16,185,129,.55);
color: rgba(5,150,105,1);
box-shadow: 0 10px 20px rgba(0,0,0,.10);
white-space:nowrap;
flex:0 0 auto;
}
.miniMeta{
margin-top:6px;
font-size:13px;
font-weight:900;
color: rgba(15,23,42,.55);
letter-spacing:.2px;
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
}
@media (max-width:420px){
/* ‚úÖ FIX: ‡πÄ‡∏î‡∏¥‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå price{...} ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏™‡πÑ‡∏ï‡∏•‡πå ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô .price */
.price{font-size:24px}
.statusBelow{font-size:14px; padding:7px 10px;}
.miniMeta{font-size:12px;}
}
.descBox{
margin-top:12px;
background: rgba(255,255,255,.92);
border: 2px solid rgba(59,130,246,.35);
border-radius: 18px;
box-shadow: 0 10px 22px rgba(0,0,0,.08);
padding:12px 12px;
}
.descText{
font-weight:950;
color: rgba(15,23,42,.92);
line-height:1.45;
white-space:pre-wrap;
word-break:break-word;
}
.descEmpty{
color: rgba(15,23,42,.55);
font-weight:900;
}
.gridInfo{
margin-top:14px;
display:grid;
grid-template-columns: 1fr;
gap:10px;
}
@media(min-width:900px){
.gridInfo{grid-template-columns: repeat(3, 1fr);}
}
.infoBox{
background: rgba(15,23,42,.05);
border:1px solid rgba(15,23,42,.06);
border-radius: 18px;
padding:12px 12px;
display:flex; justify-content:space-between; gap:10px;
font-weight:1100;
}
.k{color:rgba(15,23,42,.55); font-weight:900;}
.v{color:rgba(15,23,42,.95); font-weight:1100; text-align:right; white-space:pre-wrap;}
.errorBox{
margin-top:14px;
padding:14px;
border-radius: 18px;
background: rgba(255,255,255,.7);
border:1px solid rgba(255,255,255,.65);
font-weight:1100;
color:#8b1d1d;
display:none;
}
.skeleton{
background: linear-gradient(90deg, rgba(255,255,255,.55), rgba(255,255,255,.25), rgba(255,255,255,.55));
background-size: 200% 100%;
animation: shimmer 1.2s infinite linear;
}
@keyframes shimmer{
0%{background-position: 200% 0;}
100%{background-position: -200% 0;}
}
.pageLoader{
position:fixed;
inset:0;
display:flex;
align-items:center;
justify-content:center;
background: radial-gradient(ellipse at top, rgba(255,255,255,.25), rgba(255,255,255,0) 55%) , var(--bg);
z-index:99999;
}
.loaderPanel{
text-align:center;
padding:18px 22px;
border-radius: 26px;
background: rgba(255,255,255,.18);
border: 1px solid var(--line);
backdrop-filter: blur(10px);
box-shadow: 0 18px 40px rgba(0,0,0,.16);
max-width: 92vw;
}
.loaderEmojis{
display:flex;
gap:18px;
justify-content:center;
align-items:center;
font-size:52px;
line-height:1;
filter: drop-shadow(0 10px 20px rgba(0,0,0,.18));
}
.loaderEmojis span{
display:inline-block;
animation: bounce 0.9s ease-in-out infinite;
}
.loaderEmojis span:nth-child(2){ animation-delay: .12s; }
.loaderEmojis span:nth-child(3){ animation-delay: .24s; }
@keyframes bounce{
0%,100%{ transform: translateY(0); opacity:.95; }
50%{ transform: translateY(-12px); opacity:1; }
}
.loaderText{
margin-top:12px;
font-weight:1100;
letter-spacing:.6px;
color: rgba(15,23,42,.92);
text-shadow: 0 10px 22px rgba(0,0,0,.10);
font-size:22px;
white-space:nowrap;
}
@media (max-width:420px){
.loaderEmojis{font-size:44px}
.loaderText{font-size:18px}
}
.navArrow{
position:absolute;
top:50%;
transform: translateY(-50%);
width:54px;
height:54px;
border-radius: 999px;
border:1px solid rgba(255,255,255,.55);
background: rgba(255,255,255,.22);
backdrop-filter: blur(8px);
box-shadow: 0 10px 22px rgba(0,0,0,.14);
display:grid;
place-items:center;
cursor:pointer;
user-select:none;
z-index:5;
}
.navArrow:active{ transform: translateY(-50%) scale(.98); }
.navArrow svg{
width:24px;height:24px;
stroke: rgba(255,255,255,.95);
opacity:.95;
}
.navLeft{ left:14px; }
.navRight{ right:14px; }
@media (max-width:420px){
.navArrow{ width:48px;height:48px; }
.navArrow svg{ width:22px;height:22px; }
}
.otherSection{
margin-top:14px;
padding:14px;
border-radius: 18px;
background: rgba(255,255,255,.65);
border: 1px solid rgba(255,255,255,.65);
}
.otherTitle{
font-weight:1100;
letter-spacing:.3px;
color: rgba(15,23,42,.88);
display:flex;
align-items:center;
justify-content:space-between;
gap:10px;
}
.otherHint{
font-weight:900;
color: rgba(15,23,42,.55);
font-size:12px;
white-space:nowrap;
}
.otherGrid{
margin-top:12px;
display:grid;
grid-template-columns: repeat(2, minmax(0, 1fr));
gap:12px;
}
.otherCard{
border-radius: 18px;
background: rgba(255,255,255,.92);
border: 1px solid rgba(15,23,42,.06);
box-shadow: 0 10px 22px rgba(0,0,0,.08);
overflow:hidden;
cursor:pointer;
user-select:none;
transition: transform .12s ease;
}
.otherCard:active{ transform: scale(.985); }
.otherImg{
width:100%;
aspect-ratio: 16/10;
object-fit:cover;
display:block;
background:#e8f0fb;
}
.otherBody{
padding:10px 10px 12px;
display:flex;
flex-direction:column;
gap:6px;
}
.otherTopRow{
display:flex;
align-items:center;          
justify-content:space-between;
gap:6px;                    
flex-wrap:nowrap;           
}
.otherPlot{
font-weight:1100;
font-size:13px;
color: rgba(15,23,42,.95);
white-space:nowrap;         
overflow:hidden;
text-overflow:ellipsis;
flex:1 1 auto;
min-width:0;
}
.otherStatus{
display:inline-flex;
align-items:center;
justify-content:center;
padding:4px 7px;            
border-radius: 999px;
font-weight:1000;
font-size:10.5px;           
line-height:1;
background: rgba(255,255,255,.92);
border: 2px solid rgba(15,23,42,.15);
color: rgba(15,23,42,.88);
white-space:nowrap;         
flex:0 0 auto;
}
.otherMeta{
font-weight:400;            
font-size:10.5px;           
letter-spacing:.1px;
color: rgba(15,23,42,.55);
white-space:normal;
overflow:visible;
text-overflow:clip;
display:flex;
flex-direction:column;
gap:2px;
line-height:1.15;
}
.otherMeta .mLine{
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
}
.otherPrice{
font-weight:1100;
font-size:16px;
color: rgba(15,23,42,.92);
white-space:nowrap;
}
.otherId{
font-weight:600;
font-size:11px;
letter-spacing:-0.2px;
color: rgba(15,23,42,.55);
white-space:nowrap;
overflow:hidden;
text-overflow:clip;
}
@media (max-width: 420px) {
  .otherPlot { font-size: 12px; }
  .otherStatus { font-size: 10px; padding:3px 6px; }
  .otherMeta { font-size: 10.5px; }
}
.shareSection{
margin-top:14px;
padding:14px;
border-radius: 18px;
background: rgba(255,255,255,.65);
border: 1px solid rgba(255,255,255,.65);
}
.shareTopIcon{
display:flex;
justify-content:center;
align-items:center;
padding:8px 0 10px;
opacity:.85;
}
.shareRow{
display:flex;
gap:14px;
justify-content:center;
overflow:auto;
padding:10px 8px 6px;
scroll-snap-type: x mandatory;
-webkit-overflow-scrolling: touch;
scrollbar-width: none;
}
.shareRow::-webkit-scrollbar{ display:none; }
.shareBtn{
flex:0 0 auto;
width:58px;
scroll-snap-align:center;
border:0;
background:transparent;
cursor:pointer;
text-align:center;
user-select:none;
}
.shareCircle{
width:52px; height:52px;
border-radius:999px;
background: rgba(255,255,255,.9);
border: 1px solid rgba(15,23,42,.08);
box-shadow: 0 10px 22px rgba(0,0,0,.10);
display:grid;
place-items:center;
margin:0 auto;
}
.shareLbl{
margin-top:6px;
font-size:11px;
font-weight:900;
color: rgba(15,23,42,.65);
white-space:nowrap;
}
.shareBtn:active .shareCircle{ transform: scale(.97); }
#shareCanvas{ display:none; }
.fbVisitWrap{
margin-top: 10px;
display:flex;
justify-content:center;
}
.fbVisitBtn{
width:min(640px, 100%);
display:flex;
align-items:center;
justify-content:center;
gap:10px;
padding: 12px 14px;
border-radius: 18px;
text-decoration:none;
font-weight:1100;
letter-spacing:.2px;
background: rgba(255,255,255,.90);
border: 2px solid rgba(59,130,246,.55);
box-shadow: 0 10px 22px rgba(0,0,0,.10);
color:#1d4ed8;
user-select:none;
cursor:pointer;
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
}
.fbVisitBtn:active{ transform: scale(.99); }
.fbVisitIcon{
width:28px; height:28px;
border-radius: 12px;
display:grid;
place-items:center;
flex:0 0 auto;
background: rgba(29,78,216,.10);
}
.fbVisitBtn.hidden{ display:none; }
.quickLinks{
margin-top: 10px;
display:flex;
flex-direction:column;       
align-items:center;
gap:10px;
}
.quickBtn{
width:min(640px, 100%);      
display:flex;
align-items:center;
justify-content:center;
gap:10px;
padding: 12px 14px;
border-radius: 18px;
text-decoration:none;
font-weight:1100;
letter-spacing:.2px;
background: rgba(255,255,255,.90);
border: 2px solid rgba(15,23,42,.12);
box-shadow: 0 10px 22px rgba(0,0,0,.10);
color: rgba(15,23,42,.92);
user-select:none;
cursor:pointer;
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
}
.quickBtn:active{ transform: scale(.99); }
.quickIcon{
width:28px; height:28px;
border-radius: 12px;
display:grid;
place-items:center;
flex:0 0 auto;
background: rgba(15,23,42,.08);
}
.quickBtnPrimary{
border-color: rgba(59,130,246,.45);
color:#1d4ed8;
}
.quickBtnPrimary .quickIcon{
background: rgba(29,78,216,.10);
}
.quickBtn.hidden{ display:none; }
@media (max-width:420px){
  .quickBtn{ padding:11px 12px; border-radius:16px; font-size:12px; }
  .quickIcon{ width:24px; height:24px; border-radius:11px; }
}

/* ====== Bottom dock (‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏Ñ‡∏∏‡∏ì) ====== */
.wrap{ padding-bottom: 92px; }
.bottomDock{
position:fixed;
left:0; right:0; bottom:0;
z-index:9999;
padding: 10px 10px calc(10px + env(safe-area-inset-bottom));
background: rgba(255,255,255,.40);
backdrop-filter: blur(14px);
border-top: 1px solid rgba(255,255,255,.55);
}
.dockInner{
max-width:1100px;
margin:0 auto;
display:grid;
grid-template-columns: repeat(5, minmax(0, 1fr));
gap:10px;
}
.dockBtn{
display:flex;
align-items:center;
justify-content:center;
gap:8px;
padding: 12px 10px;
border-radius: 18px;
text-decoration:none;
font-weight: 1100;
letter-spacing:.2px;
background: rgba(255,255,255,.78);
border: 1px solid rgba(15,23,42,.10);
box-shadow: 0 10px 22px rgba(0,0,0,.10);
color: rgba(15,23,42,.92);
user-select:none;
cursor:pointer;
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
}
.dockBtn:active{ transform: scale(.99); }
.dockIcon{
width:26px; height:26px;
border-radius: 12px;
display:grid;
place-items:center;
font-size:14px;
flex:0 0 auto;
background: rgba(15,23,42,.08);
}
.dockBtn.disabled{
opacity:.42;
pointer-events:none;
}
@media (max-width:420px){
.dockBtn{ padding:11px 8px; border-radius:16px; font-size:11px; }
.dockIcon{ width:24px; height:24px; border-radius:11px; }
}
</style>
</head>
<body>
<div class="pageLoader" id="pageLoader" aria-label="loading">
  <div class="loaderPanel">
    <div class="loaderEmojis" aria-hidden="true">
      <span>üè†</span><span>‚ú®</span><span>üå¥</span>
    </div>
    <div class="loaderText">Smart Properties System</div>
  </div>
</div>

<div class="wrap">
  <div class="topbar">
    <div class="brand">
      <a class="logo" id="homeLink" href="index.html" aria-label="Home">
        <svg viewBox="0 0 24 24" fill="none" stroke="rgba(15,23,42,.92)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M3 10.5L12 3l9 7.5"></path>
          <path d="M5 10v10a1 1 0 0 0 1 1h4v-6h4v6h4a1 1 0 0 0 1-1V10"></path>
        </svg>
      </a>

      <div class="titles">
        <h1 id="pageTitle">Detail Plot: -</h1>
        <div class="sub" id="subTitle">Details ¬∑ ...</div>
      </div>
    </div>
    <button class="backBtn" id="btnBack">‚Üê</button>
  </div>

  <div class="errorBox" id="errBox"></div>

  <div class="card" id="mainCard">
    <div class="gallery" id="gallery">
      <img class="mainSlide skeleton" id="mainImg" alt="main" />
      <div class="tagTopLeft" id="tagPlot">-</div>
      <div class="tagBottomRight" id="tagCount">0 / 0</div>

      <div class="navArrow navLeft" id="btnPrev" aria-label="previous">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
          <path d="M15 18l-6-6 6-6"></path>
        </svg>
      </div>
      <div class="navArrow navRight" id="btnNext" aria-label="next">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 6l6 6-6 6"></path>
        </svg>
      </div>
    </div>

    <div class="thumbStrip" id="thumbStrip"></div>

    <div class="content">
      <div class="headRow">
        <div class="hp" id="hpText">...</div>
        <div class="price" id="priceText">‡∏ø0</div>
        <div class="statusBelow" id="statusBelow">-</div>
      </div>

      <div class="miniMeta" id="miniMeta">Land - ¬∑ Living -</div>

      <div class="descBox" id="descBox">
        <div class="descText" id="descText">-</div>
      </div>

      <div class="gridInfo" id="infoGrid"></div>

      <!-- ====== SHARE / LINKS ====== -->
      <div class="shareSection" id="shareSection">
        <div class="shareTopIcon" aria-hidden="true" title="Share">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="rgba(15,23,42,.85)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="18" cy="5" r="2"></circle>
            <circle cx="6" cy="12" r="2"></circle>
            <circle cx="18" cy="19" r="2"></circle>
            <path d="M8 12l8-7"></path>
            <path d="M8 12l8 7"></path>
          </svg>
        </div>

        <div class="shareRow" id="shareRow"></div>

        <div class="fbVisitWrap">
          <a id="fbVisitBtn" class="fbVisitBtn hidden" href="#" target="_blank" rel="noopener">
            <span class="fbVisitIcon" aria-hidden="true">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="#1877F2">
                <path d="M22 12.06C22 6.504 17.523 2 12 2S2 6.504 2 12.06C2 17.082 5.657 21.245 10.438 22v-7.03H7.898v-2.91h2.54V9.845c0-2.522 1.492-3.916 3.777-3.916 1.094 0 2.238.196 2.238.196v2.475h-1.26c-1.243 0-1.63.776-1.63 1.57v1.89h2.773l-.443 2.91h-2.33V22C18.343 21.245 22 17.082 22 12.06z"/>
              </svg>
            </span>
            <span id="fbVisitText">Visit our Facebook Page</span>
          </a>
        </div>

        <div class="quickLinks" id="quickLinks">
          <a id="openMapBtn" class="quickBtn hidden" href="#" target="_blank" rel="noopener">
            <span class="quickIcon" aria-hidden="true">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="rgba(15,23,42,.85)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 20l-5 2V6l5-2 6 2 5-2v16l-5 2-6-2z"></path>
                <path d="M9 4v16"></path>
                <path d="M15 6v16"></path>
              </svg>
            </span>
            <span>Open Map</span>
          </a>

          <a id="virtualTourBtn" class="quickBtn quickBtnPrimary hidden" href="#" target="_blank" rel="noopener">
            <span class="quickIcon" aria-hidden="true">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#1d4ed8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 10l9-7 9 7"></path>
                <path d="M5 10v10h14V10"></path>
                <path d="M10 20v-6h4v6"></path>
              </svg>
            </span>
            <span>Virtual Tour</span>
          </a>
        </div>

        <canvas id="shareCanvas" width="1200" height="630"></canvas>
      </div>
      <!-- ====== END SHARE / LINKS ====== -->

      <div class="otherSection" id="otherSection">
        <div class="otherTitle">
          <div>Other Plots</div>
          <div class="otherHint">Tap to view details</div>
        </div>
        <div class="otherGrid" id="otherGrid"></div>
      </div>

    </div>
  </div>
</div>

<div class="bottomDock" id="bottomDock" aria-label="Downloads">
  <div class="dockInner">
    <a class="dockBtn disabled" id="dockSales" href="#" target="_blank" rel="noopener">
      <span class="dockIcon">üìÑ</span>
      <span>Sales PDF</span>
    </a>
    <a class="dockBtn disabled" id="dockMaterial" href="#" target="_blank" rel="noopener">
      <span class="dockIcon">üìÑ</span>
      <span>Material PDF</span>
    </a>
    <a class="dockBtn disabled" id="dockFloorplan" href="#" target="_blank" rel="noopener">
      <span class="dockIcon">üìÑ</span>
      <span>Floor Plan</span>
    </a>

    <a class="dockBtn" id="dockCustomerPDF" href="#" target="_blank" rel="noopener">
      <span class="dockIcon">üßæ</span>
      <span>Customer</span>
    </a>
    <a class="dockBtn" id="dockAgentPDF" href="#" target="_blank" rel="noopener">
      <span class="dockIcon">üßë‚Äçüíº</span>
      <span>Agent</span>
    </a>
  </div>
</div>

<script>
/** =========================
* CONFIG
* ========================= */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby6Dwj1yHD9QZ5FB23UDz5Y4LkZLoY7BCAHtJqE5N2j7RObm6hhDXKd-0g4DqyMkc7e/exec";
const qs = new URLSearchParams(location.search);
const hpId = qs.get("id") || qs.get("hpId") || "";
const project = qs.get("project") || "HP00";

/** ‚úÖ TOKEN handling */
const TOKEN_QS = (qs.get("token") || "").trim();
const TOKEN_LS = (localStorage.getItem("HP_AUTH_TOKEN") || "").trim();
let token = TOKEN_QS || TOKEN_LS;

if (TOKEN_QS) localStorage.setItem("HP_AUTH_TOKEN", TOKEN_QS);

function goGateway(reason){
  try{
    if (reason) console.warn("[AUTH]", reason);
    const back = encodeURIComponent(location.pathname + location.search);
    location.href = `gateway.html?project=${encodeURIComponent(project)}&back=${back}`;
  }catch(e){
    location.href = `gateway.html?project=${encodeURIComponent(project)}`;
  }
}
function clearToken(){
  try{ localStorage.removeItem("HP_AUTH_TOKEN"); }catch(e){}
  token = "";
}

(function setHomeLink(){
  const a = document.getElementById("homeLink");
  if(!a) return;
  const t = token ? `&token=${encodeURIComponent(token)}` : "";
  a.href = `index.html?project=${encodeURIComponent(project)}${t}`;
})();

function showLoader(){ const el = document.getElementById("pageLoader"); if(el) el.style.display = "flex"; }
function hideLoader(){ const el = document.getElementById("pageLoader"); if(el) el.style.display = "none"; }

/** JSONP */
function jsonp(url, timeoutMs = 20000){
  return new Promise((resolve, reject) => {
    const cb = "cb_" + Math.random().toString(36).slice(2);
    const script = document.createElement("script");
    const timer = setTimeout(() => { cleanup(); reject(new Error("timeout")); }, timeoutMs);
    function cleanup(){
      clearTimeout(timer);
      if (script.parentNode) script.parentNode.removeChild(script);
      try{ delete window[cb]; }catch(e){ window[cb]=undefined; }
    }
    window[cb] = (data) => { cleanup(); resolve(data); };

    const sep = url.includes("?") ? "&" : "?";
    script.src = url + sep + "callback=" + encodeURIComponent(cb) + "&t=" + Date.now();
    script.onerror = () => { cleanup(); reject(new Error("jsonp_error")); };
    document.body.appendChild(script);
  });
}

function showError(msg, showLoginBtn = false){
  const box = document.getElementById("errBox");
  box.style.display = "block";
  box.innerHTML = "";
  const p = document.createElement("div");
  p.textContent = msg;
  box.appendChild(p);

  if (showLoginBtn){
    const btn = document.createElement("button");
    btn.textContent = "‡πÑ‡∏õ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà";
    btn.style.marginTop = "10px";
    btn.style.padding = "10px 12px";
    btn.style.borderRadius = "14px";
    btn.style.border = "0";
    btn.style.cursor = "pointer";
    btn.style.fontWeight = "900";
    btn.style.background = "rgba(15,23,42,.9)";
    btn.style.color = "#fff";
    btn.onclick = () => goGateway("manual login");
    box.appendChild(btn);
  }
}
function hideError(){
  const box = document.getElementById("errBox");
  box.style.display = "none";
  box.textContent = "";
}

function toNumber(x){
  const s = String(x ?? "").replace(/,/g,"").trim();
  const n = Number(s);
  return Number.isFinite(n) ? n : 0;
}
function moneyTHB(x){
  const n = toNumber(x);
  return "‡∏ø" + n.toLocaleString("en-US");
}

function cleanDriveImage(url){
  const u = String(url || "").trim();
  if(!u) return "";
  if (u.includes("lh3.googleusercontent.com/d/")) return u;
  let id = "";
  const m1 = u.match(/\/d\/([a-zA-Z0-9_-]+)/);
  if (m1) id = m1[1];
  const m2 = u.match(/[?&]id=([a-zA-Z0-9_-]+)/);
  if (!id && m2) id = m2[1];
  const m3 = u.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);
  if (!id && m3) id = m3[1];
  if (id) return "https://lh3.googleusercontent.com/d/" + id;
  return u;
}

function statusStyle(statusRaw){
  const s = String(statusRaw||"").trim().toLowerCase();
  if (s.includes("available")) return {border:"rgba(16,185,129,.65)", text:"rgba(5,150,105,1)"};
  if (s.includes("under")) return {border:"rgba(14,165,233,.55)", text:"rgba(2,132,199,1)"};
  if (s.includes("reserved")) return {border:"rgba(245,158,11,.55)", text:"rgba(180,83,9,1)"};
  if (s.includes("sold")) return {border:"rgba(244,63,94,.55)", text:"rgba(190,18,60,1)"};
  return {border:"rgba(15,23,42,.25)", text:"rgba(15,23,42,.92)"};
}

document.getElementById("btnBack").addEventListener("click", () => {
  const t = token ? `&token=${encodeURIComponent(token)}` : "";
  history.length > 1 ? history.back() : (location.href = `index.html?project=${encodeURIComponent(project)}${t}`);
});

let images = [];
let idx = 0;
let CURRENT_DETAIL = null;

function setMain(i){
  idx = Math.max(0, Math.min(i, images.length-1));
  const mainImg = document.getElementById("mainImg");
  mainImg.classList.remove("skeleton");
  mainImg.src = images[idx] || mainImg.src;
  document.getElementById("tagCount").textContent = `${idx+1} / ${images.length || 0}`;
  document.querySelectorAll(".thumb").forEach((t, k)=> t.classList.toggle("active", k===idx));
}

function renderThumbs(){
  const strip = document.getElementById("thumbStrip");
  strip.innerHTML = "";
  images.forEach((src, i)=>{
    const im = document.createElement("img");
    im.className = "thumb" + (i===idx ? " active": "");
    im.src = src;
    im.loading = "lazy";
    im.decoding = "async";
    im.addEventListener("click", ()=>setMain(i));
    strip.appendChild(im);
  });
}

function enableSwipe(){
  const gallery = document.getElementById("gallery");
  let startX = 0, dx = 0;
  gallery.addEventListener("touchstart", (e)=>{
    startX = e.touches[0].clientX;
    dx = 0;
  }, {passive:true});
  gallery.addEventListener("touchmove", (e)=>{
    dx = e.touches[0].clientX - startX;
  }, {passive:true});
  gallery.addEventListener("touchend", ()=>{
    if(Math.abs(dx) < 35) return;
    if(dx < 0) setMain(idx+1);
    else setMain(idx-1);
  });
}

function safeText(v){
  const s = String(v ?? "").trim();
  return s === "" ? "-" : s;
}
function pick(obj, keys){
  for (const k of keys){
    if (obj && obj[k] !== undefined && obj[k] !== null && String(obj[k]).trim() !== "") return obj[k];
  }
  return "";
}
function fmtSqm(v){
  const s = safeText(v);
  if(s === "-") return "-";
  const low = s.toLowerCase();
  if (low.includes("sq") || low.includes("‡∏ï‡∏£.‡∏°") || low.includes("m2") || low.includes("m¬≤")) return s;
  return s + " sq.m";
}

/** =========================================================
 * ‚úÖ NEW COLUMN KEYS (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà + ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏°)
 * ========================================================= */
const LAND_SQW_KEYS = [
  "Land_Area_sq_w", "land_area_sq_w", "Land_Area_SQW",
  "Land Area (sq.w)", "Land Area (sqw)", "Land Area sq.w", "Land Area sqw"
];

const LAND_SQM_KEYS = [
  "Land_Area_sq_m", "land_area_sq_m", "Land_Area_SQM",
  "Land Area (sq.m)", "Land Area (sqm)", "Land Area sqm", "Land Area sq.m"
];

const LIVING_SQM_KEYS = [
  "Living_Area_sq_m", "living_area_sq_m", "Living_Area_SQM",
  "Living Area (sq.m)", "Living Area (sqm)", "Living Area sqm", "Living Area sq.m"
];

const POOL_SIZE_KEYS = [
  "Pool_Size","pool_size","PoolSize","POOL_SIZE","Pool Size"
];

const POOL_DEPTH_KEYS = [
  "Pool_Depth","pool_depth","PoolDepth","POOL_DEPTH","Pool Depth"
];

const ZONE_KEYS = ["Zone","zone","ZONE"];

function renderDescription(detail){
  const desc = safeText(pick(detail, ["Description","description","Desc"]));
  const box = document.getElementById("descBox");
  const el = document.getElementById("descText");
  if(!box || !el) return;
  if(desc === "-" ){
    box.style.display = "none";
    return;
  }
  box.style.display = "block";
  el.textContent = desc;
  el.classList.remove("descEmpty");
}

function renderMiniMeta(detail){
  const landM = fmtSqm(pick(detail, LAND_SQM_KEYS));
  const livingM = fmtSqm(pick(detail, LIVING_SQM_KEYS));
  const el = document.getElementById("miniMeta");
  if(!el) return;
  el.textContent = `Land ${landM} ¬∑ Living ${livingM}`;
}

function renderInfo(detail){
  const grid = document.getElementById("infoGrid");

  // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á ‚Äú‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡∏°‡πà‚Äù ‡πÄ‡∏õ‡πá‡∏ô label
  const items = [
    ["Project_Name", safeText(pick(detail, ["Project_Name","ProjectName","Project"]))],
    ["District", safeText(pick(detail, ["District","district"]))],
    ["SubDistrict", safeText(pick(detail, ["SubDistrict","Sub_District","subdistrict"]))],
    ["Zone", safeText(pick(detail, ZONE_KEYS))],
    ["Badge", safeText(pick(detail, ["Badge","badge"]))],
    ["Bedrooms", safeText(pick(detail, ["Bedrooms","Bedroom","beds"]))],
    ["Bathrooms", safeText(pick(detail, ["Bathrooms","Bathroom","baths"]))],

    ["Land_Area_sq_w", safeText(pick(detail, LAND_SQW_KEYS))],
    ["Land_Area_sq_m", safeText(pick(detail, LAND_SQM_KEYS))],
    ["Living_Area_sq_m", safeText(pick(detail, LIVING_SQM_KEYS))],

    ["Pool_Size", safeText(pick(detail, POOL_SIZE_KEYS))],
    ["Pool_Depth", safeText(pick(detail, POOL_DEPTH_KEYS))],

    ["Furnishing", safeText(pick(detail, ["Furnishing","furnishing"]))],
    ["Price_SQM", safeText(pick(detail, ["Price_SQM","PriceSQM"]))],
    ["Status", safeText(pick(detail, ["Status","status"]))],
    ["Parking", safeText(pick(detail, ["Parking","parking"]))],
    ["Extras", safeText(pick(detail, ["Extras","extras"]))],
    ["Electricity", safeText(pick(detail, ["Electricity","electricity"]))],
  ];

  grid.innerHTML = "";
  for(const [k,v] of items){
    const box = document.createElement("div");
    box.className = "infoBox";
    box.innerHTML = `<div class="k">${k}</div><div class="v">${v}</div>`;
    grid.appendChild(box);
  }
}

function normalizeLink(v){
  const s = String(v ?? "").trim();
  return s && s !== "-" ? s : "";
}
function setDockLink(elId, link){
  const el = document.getElementById(elId);
  if(!el) return;
  const href = normalizeLink(link);
  if(!href){
    el.classList.add("disabled");
    el.setAttribute("href", "#");
    return;
  }
  el.classList.remove("disabled");
  el.setAttribute("href", href);
}

/** ====== PDF: generate then open ====== */
async function ensurePdfAndOpen(type){
  try{
    hideError();
    showLoader();

    let url = `${SCRIPT_URL}?mode=generatePdf&project=${encodeURIComponent(project)}&hpId=${encodeURIComponent(hpId)}&type=${encodeURIComponent(type)}`;
    if (token) url += `&token=${encodeURIComponent(token)}`;

    const res = await jsonp(url, 60000);

    if (res && res.error){
      const msg = String(res.error || "");
      if (msg.toLowerCase().includes("unauthorized")){
        clearToken();
        hideLoader();
        goGateway("expired/invalid token");
        return;
      }
      showError("‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + msg, msg.toLowerCase().includes("forbidden"));
      hideLoader();
      return;
    }

    const link = res && res.url ? String(res.url) : "";
    if (!link){
      showError("‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏ü‡∏•‡πå");
      hideLoader();
      return;
    }

    window.open(link, "_blank", "noopener,noreferrer");
    hideLoader();
  }catch(e){
    showError("‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏ï‡∏£‡∏ß‡∏à Deploy Apps Script / Permission / Template ID / Folder ID)");
    hideLoader();
  }
}

/** ====== AD: FB_Link ====== */
function pickFbLink(detail){
  const keys = ["FB_Link","FBLink","FB_LINK","facebook","Facebook","FB"];
  for(const k of keys){
    const v = detail ? detail[k] : "";
    const s = String(v ?? "").trim();
    if(s && s !== "-") return s;
  }
  return "";
}
function setFbVisitBar(link){
  const a = document.getElementById("fbVisitBtn");
  if(!a) return;

  const wrap = a.closest(".fbVisitWrap");
  const href = normalizeLink(link);

  if(!href){
    a.classList.add("hidden");
    a.setAttribute("href", "#");
    if (wrap) wrap.style.display = "none";
    return;
  }
  a.classList.remove("hidden");
  a.setAttribute("href", href);
  if (wrap) wrap.style.display = "flex";
}

/** ====== AE: Map_Link ====== */
function pickMapLink(detail){
  const keys = ["Map_Link","MapLink","GoogleMap","Google_Maps","Map","Location","Location_Link"];
  for(const k of keys){
    const v = detail ? detail[k] : "";
    const s = String(v ?? "").trim();
    if(s && s !== "-") return s;
  }
  return "";
}
function buildOpenMapUrl(link){
  const raw = String(link || "").trim();
  if(!raw) return "";
  if (raw.includes("google.com/maps")) return raw;
  if (raw.startsWith("http")) return raw;
  return `https://www.google.com/maps?q=${encodeURIComponent(raw)}`;
}

/** ====== AF: Virtual_Tour ====== */
function pickVirtualTour(detail){
  const keys = ["Virtual_Tour","VirtualTour","Virtual_TOUR","VirtualTour_Link","Virtual","Tour","VR_Link","Virtual_Link"];
  for(const k of keys){
    const v = detail ? detail[k] : "";
    const s = String(v ?? "").trim();
    if(s && s !== "-") return s;
  }
  return "";
}
function setQuickLinks(mapLink, tourLink){
  const wrap = document.getElementById("quickLinks");
  const mapBtn = document.getElementById("openMapBtn");
  const tourBtn = document.getElementById("virtualTourBtn");

  const mapHref = normalizeLink(mapLink);
  if(mapHref){
    mapBtn.classList.remove("hidden");
    mapBtn.href = buildOpenMapUrl(mapHref);
  }else{
    mapBtn.classList.add("hidden");
    mapBtn.href = "#";
  }

  const tourHref = normalizeLink(tourLink);
  if(tourHref){
    tourBtn.classList.remove("hidden");
    tourBtn.href = tourHref;
  }else{
    tourBtn.classList.add("hidden");
    tourBtn.href = "#";
  }

  if (wrap) wrap.style.display = (mapHref || tourHref) ? "flex" : "none";
}

/** =========================
* SHARE (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°)
* ========================= */
function getPublicShareUrl(){
  const u = new URL(location.href);
  u.searchParams.delete("token");
  if (hpId) u.searchParams.set("id", hpId);
  if (project) u.searchParams.set("project", project);
  return u.toString();
}
function openPopup(url){
  const w = 640, h = 640;
  const left = (screen.width - w) / 2;
  const top = (screen.height - h) / 2;
  window.open(url, "_blank", `noopener,noreferrer,width=${w},height=${h},left=${left},top=${top}`);
}
async function copyToClipboard(text){
  try{ await navigator.clipboard.writeText(text); return true; }
  catch(e){
    const ta = document.createElement("textarea");
    ta.value = text; ta.style.position="fixed"; ta.style.left="-9999px";
    document.body.appendChild(ta); ta.select();
    try{ document.execCommand("copy"); }catch(err){}
    document.body.removeChild(ta); return true;
  }
}
function renderShareIcons(detail){
  const row = document.getElementById("shareRow");
  if(!row) return;

  const url = getPublicShareUrl();
  const plot = String(detail?.Plot || hpId || "Property").trim() || "Property";
  const price = moneyTHB(detail?.Price || 0);
  const title = `Plot ${plot} ¬∑ ${price}`;

  const items = [
    {label:"Facebook", onClick: ()=> openPopup(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`)},
    {label:"Copy", onClick: async()=> { await copyToClipboard(url); }},
  ];

  row.innerHTML = items.map((it, i)=>`
    <button class="shareBtn" type="button" data-i="${i}">
      <div class="shareCircle">üîó</div>
      <div class="shareLbl">${it.label}</div>
    </button>
  `).join("");

  row.querySelectorAll(".shareBtn").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const i = Number(btn.getAttribute("data-i"));
      const it = items[i];
      if(it && it.onClick) it.onClick();
    });
  });
}

/** =========================
* Other Plots
* ========================= */
function getUnitId(u){ return String(u?.HP_ID || u?.id || u?.hpId || u?.Unit_ID || "").trim(); }
function getPlot(u){ return String(u?.Plot || u?.plot || u?.Unit_Plot || u?.Plot_No || "").trim(); }
function getThumb(u){ return cleanDriveImage(u?.Thumbnail_Image || u?.thumbnail || u?.thumb || u?.thumbUrl || ""); }
function getStatus(u){ return String(u?.Status || u?.status || u?.unitStatus || "-").trim() || "-"; }
function getPrice(u){ return u?.Price ?? u?.price ?? 0; }
function getSystemStatus(u){
  const keys = ["System_Status","SystemStatus","system_status","SYS_Status","Sys_Status","SYSTEM_STATUS","sysStatus"];
  const v = pick(u, keys);
  return String(v || "").trim();
}
function isHiddenBySystemStatus(u){
  const ss = getSystemStatus(u).toLowerCase();
  return ss.includes("offline") || ss.includes("pending");
}
function getLandLivingLines(u){
  const land = safeText(pick(u, LAND_SQM_KEYS));
  const living = safeText(pick(u, LIVING_SQM_KEYS));
  return {
    landLine: land === "-" ? "Land -" : `Land ${land} sq.m`,
    livingLine: living === "-" ? "Living -" : `Living ${living} sq.m`
  };
}
function renderOtherUnits(units){
  const grid = document.getElementById("otherGrid");
  const section = document.getElementById("otherSection");
  if(!Array.isArray(units) || units.length === 0){
    section.style.display = "none";
    return;
  }
  section.style.display = "block";
  grid.innerHTML = "";
  for(const u of units){
    const id = getUnitId(u);
    const plot = getPlot(u) || id || "-";
    const thumb = getThumb(u);
    const st = getStatus(u);
    const price = moneyTHB(getPrice(u));
    const pill = statusStyle(st);
    const lines = getLandLivingLines(u);

    const card = document.createElement("div");
    card.className = "otherCard";
    card.innerHTML = `
      <img class="otherImg" src="${thumb || "data:image/svg+xml;charset=utf-8," + encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='1200' height='800'><rect width='100%' height='100%' fill='#e6edf6'/><text x='50%' y='50%' text-anchor='middle' fill='#8aa0bb' font-size='40' font-family='Arial'>no image</text></svg>")}" alt="thumb" loading="lazy" decoding="async">
      <div class="otherBody">
        <div class="otherTopRow">
          <div class="otherPlot">${plot}</div>
          <div class="otherStatus" style="border-color:${pill.border}; color:${pill.text};">${st}</div>
        </div>
        <div class="otherPrice">${price}</div>
        <div class="otherMeta">
          <div class="mLine">${lines.landLine}</div>
          <div class="mLine">${lines.livingLine}</div>
        </div>
      </div>
    `;
    card.addEventListener("click", ()=>{
      const t = token ? `&token=${encodeURIComponent(token)}` : "";
      location.href = `details.html?id=${encodeURIComponent(id)}&project=${encodeURIComponent(project)}${t}`;
    });
    grid.appendChild(card);
  }
}
async function loadOtherUnits(){
  try{
    const url = `${SCRIPT_URL}?mode=getUnitList&project=${encodeURIComponent(project)}`;
    const data = await jsonp(url);
    if(!Array.isArray(data)){
      document.getElementById("otherSection").style.display = "none";
      return;
    }
    const filtered = data
      .filter(u => getUnitId(u) && getUnitId(u) !== String(hpId).trim())
      .filter(u => !isHiddenBySystemStatus(u))
      .slice(0, 10);
    renderOtherUnits(filtered);
  }catch(e){
    document.getElementById("otherSection").style.display = "none";
  }
}

/** LOAD */
(async function init(){
  hideError();
  showLoader();

  if(!hpId){
    showError("‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: ‡πÑ‡∏°‡πà‡∏°‡∏µ id ‡πÄ‡∏ä‡πà‡∏ô details.html?id=HP-Z001");
    hideLoader();
    return;
  }

  let url =
    `${SCRIPT_URL}?mode=getUnitDetail` +
    `&project=${encodeURIComponent(project)}` +
    `&hpId=${encodeURIComponent(hpId)}`;

  if (token) url += `&token=${encodeURIComponent(token)}`;

  let detail;
  try{
    detail = await jsonp(url);
  }catch(err){
    showError("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏ï‡∏£‡∏ß‡∏à Deploy Apps Script ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô Anyone ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ /exec)");
    hideLoader();
    return;
  }

  if(detail && detail.error){
    const errText = String(detail.error || "");
    if(errText.toLowerCase().includes("unauthorized")){
      clearToken();
      hideLoader();
      goGateway("expired/invalid token");
      return;
    }else{
      showError("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + errText, true);
      hideLoader();
      return;
    }
  }

  CURRENT_DETAIL = detail;

  const plotText = String(detail.Plot || "-").trim() || "-";
  document.getElementById("pageTitle").textContent = `Detail Plot: ${plotText}`;
  document.getElementById("tagPlot").textContent = plotText;

  document.getElementById("priceText").textContent = moneyTHB(detail.Price || 0);

  const stText = String(detail.Status || "Available").trim() || "Available";
  const stEl = document.getElementById("statusBelow");
  stEl.textContent = stText;
  const st = statusStyle(stText);
  stEl.style.borderColor = st.border;
  stEl.style.color = st.text;

  renderMiniMeta(detail);
  renderDescription(detail);
  renderShareIcons(detail);
  setFbVisitBar(pickFbLink(detail));

  const mapLink = pickMapLink(detail);
  const tourLink = pickVirtualTour(detail);
  setQuickLinks(mapLink, tourLink);

  const thumb = cleanDriveImage(detail.Thumbnail_Image || "");
  const list = String(detail.Image_List || "")
    .split(",").map(s=>cleanDriveImage(s.trim()))
    .filter(Boolean);

  images = (thumb ? [thumb, ...list.filter(x=>x!==thumb)] : list);
  if(!images.length){
    images = ["data:image/svg+xml;charset=utf-8," + encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='1200' height='800'><rect width='100%' height='100%' fill='#e6edf6'/><text x='50%' y='50%' text-anchor='middle' fill='#8aa0bb' font-size='40' font-family='Arial'>no image</text></svg>`) ];
  }

  const mainImg = document.getElementById("mainImg");
  mainImg.onload = () => { hideLoader(); };
  mainImg.onerror = () => { hideLoader(); };
  mainImg.src = images[0];
  mainImg.classList.remove("skeleton");

  renderThumbs();
  setMain(0);
  enableSwipe();

  document.getElementById("btnPrev").addEventListener("click", ()=> setMain(idx-1));
  document.getElementById("btnNext").addEventListener("click", ()=> setMain(idx+1));

  renderInfo(detail);
  loadOtherUnits();

  setDockLink("dockSales", detail.Sales_Gallery);
  setDockLink("dockMaterial", detail.Material_PDF);

  // ‚úÖ FIX: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏µ‡∏¢‡πå‡∏Ç‡∏≠‡∏á FloorPlan (‡∏Å‡∏±‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå/‡∏Ñ‡∏µ‡∏¢‡πå‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á)
  setDockLink("dockFloorplan",
    detail.FloorPlan_PDF ||
    detail.Floorplan_PDF ||
    detail.FloorPlanPDF ||
    detail.Floor_Plan_PDF ||
    ""
  );

  const customerBtn = document.getElementById("dockCustomerPDF");
  const agentBtn = document.getElementById("dockAgentPDF");

  const customerLink = normalizeLink(detail.Customer_PDF || "");
  if (customerLink){
    customerBtn.classList.remove("disabled");
    customerBtn.href = customerLink;
  } else {
    customerBtn.href = "#";
    customerBtn.classList.remove("disabled");
    customerBtn.addEventListener("click", (ev)=>{
      ev.preventDefault();
      ensurePdfAndOpen("customer");
    });
  }

  const agentLink = normalizeLink(detail.Agent_PDF || "");
  if (agentLink){
    agentBtn.classList.remove("disabled");
    agentBtn.href = agentLink;
  } else {
    agentBtn.href = "#";
    agentBtn.classList.remove("disabled");
    agentBtn.addEventListener("click", (ev)=>{
      ev.preventDefault();
      ensurePdfAndOpen("agent");
    });
  }

  hideLoader();
})();
</script>
</body>
</html>
