<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DIRECT HUB - PROPERTIES</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    body{font-family:'Kanit',sans-serif;background:#f3f5f8}
    .card-shadow{box-shadow:0 20px 40px rgba(15,23,42,.10)}
    .glass{background:rgba(255,255,255,.75);backdrop-filter: blur(10px)}
    .pill{border-radius:999px}
  </style>
</head>

<body>
<main class="max-w-6xl mx-auto px-4 py-10">
  <div id="list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
</main>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwvCiaEKxvRI9rQCXMR_F4SHqmkJT4CnAuoVgEr6RYACmfgKerp7r06m-ltBMu4GFD4/exec";
const PROJECT = new URLSearchParams(location.search).get("project") || "Project_0";

function fmtPrice(n){
  const x = Number(String(n || "").replace(/,/g,""));
  if (!Number.isFinite(x) || x <= 0) return "";
  return "‡∏ø " + x.toLocaleString("en-US");
}

function statusMeta(raw){
  const map = {
    "Available": ["‡∏ß‡πà‡∏≤‡∏á","bg-emerald-100 text-emerald-700"],
    "Under Con": ["‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á","bg-sky-100 text-sky-700"],
    "Under Construction": ["‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á","bg-sky-100 text-sky-700"],
    "Reserved": ["‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß","bg-amber-100 text-amber-700"],
    "Sold": ["‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß","bg-rose-100 text-rose-700"]
  };
  return map[raw] || ["","bg-slate-100 text-slate-600"];
}

function cardTemplate(item){
  const price = fmtPrice(item.price);
  const [statusTH,statusCls] = statusMeta(item.unitStatus || "");
  return `
  <article class="rounded-[2.5rem] bg-white card-shadow overflow-hidden">
    <div class="relative">
      <div class="aspect-[4/3] bg-slate-100 overflow-hidden">
        ${item.thumbnail
          ? `<img src="${item.thumbnail}" class="w-full h-full object-cover">`
          : `<div class="w-full h-full flex items-center justify-center text-5xl text-slate-300">üñºÔ∏è</div>`
        }
      </div>

      <!-- Z-1 / Z-2 / Z-3 -->
      <div class="absolute top-4 left-4 glass pill px-4 py-2 font-extrabold italic">
        ${item.plot || "-"}
      </div>
    </div>

    <div class="p-5">
      <!-- Info line -->
      <div class="flex flex-wrap gap-2 text-sm font-bold text-slate-700">
        <span class="px-3 py-1 rounded-xl bg-slate-100">üõè ${item.bedrooms || "-"}</span>
        <span class="px-3 py-1 rounded-xl bg-slate-100">üõÅ ${item.bathrooms || "-"}</span>
        <span class="px-3 py-1 rounded-xl bg-slate-100">üìê ${item.landSqw || "-"} sq.w</span>
        <span class="px-3 py-1 rounded-xl bg-slate-100">üè† ${item.livingSqm || "-"} sqm</span>

        ${statusTH
          ? `<span class="ml-auto px-3 py-1 rounded-xl ${statusCls}">${statusTH}</span>`
          : ""
        }
      </div>

      <!-- Price (hide if 0) -->
      ${price
        ? `<div class="mt-4 text-3xl font-extrabold italic text-slate-900">${price}</div>`
        : ""
      }

      <!-- Button -->
      <a href="details.html?id=${item.id}&project=${PROJECT}"
        class="mt-5 block w-full text-center py-4 rounded-[2rem] bg-slate-900 text-white font-extrabold italic tracking-widest hover:bg-blue-600 transition-all">
        VIEW FULL DETAILS
      </a>
    </div>
  </article>`;
}

async function load(){
  const res = await fetch(`${API_URL}?mode=getUnitList&project=${PROJECT}`);
  const data = await res.json();
  document.getElementById("list").innerHTML = data.map(cardTemplate).join("");
}
load();
</script>
</body>
</html>
