<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DASHBOARD - AGENT SMART SYSTEM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Kanit', sans-serif; background: #f8fafc; }
        /* üõ†Ô∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ ID ‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î‡πÅ‡∏ñ‡∏ß */
        .no-wrap { white-space: nowrap; }
        .dense-row td { padding: 0.5rem 0.4rem !important; border-bottom: 1px solid #f1f5f9; vertical-align: middle; }
        .dense-row th { padding: 0.6rem 0.4rem !important; font-size: 10px !important; text-transform: uppercase; }
        .status-badge { font-size: 8px; padding: 2px 6px; border-radius: 99px; font-weight: 600; text-transform: uppercase; }
        /* ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ */
        .name-col { max-width: 100px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    </style>
</head>
<body class="p-2 md:p-6 italic">

    <div class="max-w-4xl mx-auto">
        <div class="flex flex-col md:flex-row gap-2 mb-4">
            <div class="flex-1 flex gap-2">
                <div class="bg-white px-3 py-3 rounded-xl shadow-sm border border-slate-100 flex items-center min-w-fit">
                    <span id="projBrand" class="text-blue-700 font-bold text-[10px] uppercase">üìç COCO HUA HIN</span>
                </div>
                <div class="relative flex-1">
                    <i class="fa-solid fa-magnifying-glass absolute left-3.5 top-3.5 text-slate-300 text-xs"></i>
                    <input type="text" id="searchInput" oninput="localSearch()" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏´‡∏±‡∏™/‡∏ä‡∏∑‡πà‡∏≠..." class="w-full pl-9 pr-3 py-3 bg-white rounded-xl shadow-sm outline-none border-none ring-1 ring-slate-100 text-[10px] font-bold">
                </div>
            </div>
        </div>

        <div class="bg-white rounded-2xl shadow-md overflow-hidden border border-slate-100">
            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse dense-row">
                    <thead class="bg-[#1e3a8a] text-white">
                        <tr class="italic uppercase text-[9px] tracking-widest">
                            <th class="pl-4 w-[30%]">ID</th> <th class="w-[35%]">Property Name</th>
                            <th class="w-[20%] text-center">Status</th>
                            <th class="w-[15%] text-center">Manage</th>
                        </tr>
                    </thead>
                    <tbody id="unitTableBody" class="text-[11px] font-medium">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // (API_URL ‡πÅ‡∏•‡∏∞ PROJECT_ID ‡πÉ‡∏™‡πà‡∏ï‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏û‡∏µ‡πà‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö)
        const API_URL = "https://script.google.com/macros/s/AKfycbwe5Sfa4aN_17nmtgekfP4CpHXVmlL4NOpzc7cG2zvffnrgpA5u9tUNmKGnZNUpz29u/exec"; 
        const PROJECT_ID = "Project_A"; 
        let masterData = [];

        function renderTable(data) {
            document.getElementById('unitTableBody').innerHTML = data.map(u => `
                <tr class="hover:bg-blue-50/50 transition-colors">
                    <td class="pl-4 font-bold text-slate-900 no-wrap italic">${u.id}</td> <td class="font-bold text-slate-500 italic name-col">${u.name || '-'}</td>
                    <td class="text-center"><span class="${getStatusStyle(u.status)} status-badge">${u.status || 'PND'}</span></td>
                    <td class="text-center text-blue-500">
                        <button onclick="openEdit('${u.id}')" class="p-2 transition-transform active:scale-90">
                            <i class="fa-solid fa-pen-to-square"></i>
                        </button>
                    </td>
                </tr>`).join('');
        }
        
        // (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏Ñ‡∏£‡∏±‡∏ö)
        async function init() {
            const res = await fetch(`${API_URL}?mode=getUnitList&project=${PROJECT_ID}`);
            masterData = await res.json();
            renderTable(masterData);
        }
        function getStatusStyle(s) { return (s==='Live'||s==='Online') ? 'bg-green-100 text-green-600' : (s==='Sold'?'bg-red-100 text-red-600':'bg-yellow-100 text-yellow-600'); }
        window.onload = init;
    </script>
</body>
</html>
